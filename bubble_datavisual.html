<!doctype html>
<html>

<head>
	 <title>D3 tutorial</title>
	 <script src="http://d3js.org/d3.v3.min.js"></script>
</head>
 
<body>
	
	<script>
	var width = 800;
	var height = 600;
	
	var canvas = d3.select("body")
	.append("svg")
	.attr("width", width)
	.attr("height",height)
	.append("g")
	.attr("transform","translate(50,50)");
	
	var pack = d3.layout.pack()
	.size([width, height - 50])
	.padding(10);
	
	d3.json("ADdrug.json", function(data) {
		//var nodes = tree.nodes(data);
		//console.log(nodes);
		var nodes = pack.nodes(data);
		console.log(nodes);
		var node = canvas.selectAll(".node")
		.data(nodes)
		.enter()
		.append("g")
		.attr("class","node")
		.attr("transform", function (d) {
			return "translate("+d.x+","+d.y+")";
		});//node position
		
		node.append("circle")
		.attr("r", function (d) {return d.r;})
		.style("stroke", "green")
		.attr("fill",function(d) { if (d.value==25) {return "green"} 
		else if (d.value==20) {return "orange"}
		//else if (d.value==15) {return "green"}
		else {return "steelblue"};})
		//.attr("opacity", 0.9)
		.attr("opacity", function(d) { if (d.value==25) {return 0.8} 
		else if (d.value==20) {return 0.6}
		else if (d.value==15) {return 0.4}
		else {return 0.3};})
		.attr("stroke","#ADADAD")
		.attr("strok-width","2");
		
		node.append("text")
		//.attr("x",function (d) {return cx(d.cx);})
		//.attr("y",function (d) {return d.y/1.8;})
		.attr("dy", function(d){if (d.value>40) {return -d.r*0.9}
		else {return 0};})
		.attr("text-anchor","middle")
		//.text(function(d){return d.children ? "" : d.name;})
		.text(function(d){return d.value>80 ? "" : d.name;})
		.style("font-size", function(d) {
			if (d.value>50) {return 12 + "px"}
			else {return d.value/1.8 + "px"};})
		//.text(function(d){return d.name;})
		// if function!!!
		
	});
	</script>

</body>
</html>